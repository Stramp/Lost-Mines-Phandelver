---
description: C++ code conventions for Unreal Engine 5.7
globs: ["*.cpp", "*.h", "*.hpp"]
alwaysApply: false
---

# C++ Code Conventions - Unreal Engine 5.7

## Naming (CRITICAL)
- **Classes**: PascalCase with appropriate prefix:
  - `A` for Actors (ex: `AMyProject2Character`, `APlayerController`)
  - `U` for UObjects (ex: `UMyGameInstance`, `UMyComponent`)
  - `F` for Structs (ex: `FPlayerStats`, `FWeaponData`)
  - `E` for Enums (ex: `EPlayerState`, `EWeaponType`)
  - `I` for Interfaces (ex: `IInteractable`, `IDamageable`)
  - `T` for Templates (ex: `TArray`, `TMap`, `TSet`)
- **Functions**: PascalCase (ex: `BeginPlay()`, `Tick()`, `OnHit()`)
- **Variables**: PascalCase with prefixes:
  - Booleans: `b` (ex: `bIsRunning`, `bIsActive`, `bHasWeapon`)
  - Floats: no prefix (ex: `Health`, `MaxHealth`, `Speed`)
  - Integers: no prefix (ex: `AmmoCount`, `Level`)
  - Enums: `E` (ex: `EPlayerState CurrentState`)
  - Interfaces: `I` (ex: `IInteractable* InteractableObject`)
- **Constants**: `const` with PascalCase (ex: `const float MaxSpeed = 1000.0f;`)

## Macros and Annotations (ESSENTIAL)
- **ALWAYS** use Unreal macros for classes:
  - `UCLASS()` for classes that inherit from `UObject`
  - `USTRUCT()` for structs
  - `UENUM()` for enums
  - `UINTERFACE()` for interfaces
- **UPROPERTY()** - Use for:
  - `UPROPERTY(BlueprintReadWrite)` - Read/write in Blueprint
  - `UPROPERTY(BlueprintReadOnly)` - Read-only in Blueprint
  - `UPROPERTY(VisibleAnywhere)` - Visible in editor, not editable
  - `UPROPERTY(EditAnywhere)` - Editable in editor
  - `UPROPERTY(EditDefaultsOnly)` - Editable only in defaults
  - `UPROPERTY(EditInstanceOnly)` - Editable only in instances
  - `UPROPERTY(Replicated)` - Network replication
- **UFUNCTION()** - Use for:
  - `UFUNCTION(BlueprintCallable)` - Callable from Blueprint
  - `UFUNCTION(BlueprintImplementableEvent)` - Implemented in Blueprint
  - `UFUNCTION(BlueprintNativeEvent)` - Default implementation in C++, can be overridden in Blueprint
  - `UFUNCTION(Server, Reliable)` - Server RPC
  - `UFUNCTION(Client, Reliable)` - Client RPC

## Headers and Includes
- **ALWAYS** use `#include "CoreMinimal.h"` at the top of .cpp files
- Use `#pragma once` in all headers (don't use include guards)
- Use forward declarations in headers when possible:
  ```cpp
  // In header (.h)
  class APlayerController;
  class UWidget;

  // In cpp
  #include "PlayerController.h"
  #include "Components/Widget.h"
  ```
- Organize includes in this order:
  1. Corresponding header (ex: `#include "MyClass.h"`)
  2. Engine headers (ex: `#include "Engine/Engine.h"`)
  3. Project headers
  4. Plugin headers
  5. STL (avoid when possible)

## Containers and Types
- **ALWAYS** prefer Unreal containers:
  - `TArray<T>` instead of `std::vector<T>`
  - `TMap<Key, Value>` instead of `std::map<Key, Value>`
  - `TSet<T>` instead of `std::set<T>`
- **ALWAYS** use Unreal types:
  - `FString` instead of `std::string` (for mutable strings)
  - `FText` for localizable text (UI)
  - `FName` for internal names (fast, case-insensitive)
  - `FVector`, `FRotator`, `FTransform` for 3D math
  - `FLinearColor`, `FColor` for colors

## Garbage Collection (CRITICAL)
- Classes that inherit from `UObject` are managed by GC
- **ALWAYS** use `UPROPERTY()` to keep valid references to UObjects
- **NEVER** use raw pointers to UObjects without `UPROPERTY()` (will be collected by GC)
- Use `TWeakObjectPtr<UObject>` for weak references
- Use `TSoftObjectPtr<UObject>` for lazy loading
- Structs and primitive types don't need `UPROPERTY()` (but can have to expose to editor)

## File Structure
- One .h and .cpp file per class
- File name must exactly match class name
- Place source code in `Source/MyProject2/`
- Organize in subdirectories by functionality (ex: `Characters/`, `Components/`, `UI/`)

## Complete Class Example
```cpp
// MyActor.h
#pragma once
#include "CoreMinimal.h"
#include "GameFramework/Actor.h"
#include "MyActor.generated.h"

UCLASS(BlueprintType, Blueprintable)
class MYPROJECT2_API AMyActor : public AActor
{
    GENERATED_BODY()

public:
    AMyActor();

    UPROPERTY(VisibleAnywhere, BlueprintReadOnly, Category = "Components")
    class UStaticMeshComponent* MeshComponent;

    UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Gameplay")
    float Health;

    UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Gameplay")
    bool bIsActive;

    UFUNCTION(BlueprintCallable, Category = "Gameplay")
    void TakeDamage(float DamageAmount);

protected:
    virtual void BeginPlay() override;

private:
    UPROPERTY()
    class UMyComponent* MyComponent;
};
```
