---
description: CRITICAL RULE - Clean Code and Design Patterns are MANDATORY in ALL situations
globs: ["*.cpp", "*.h", "*.hpp", "*.cs"]
alwaysApply: true
---

# âš ï¸ CRITICAL RULE - CLEAN CODE AND DESIGN PATTERNS MANDATORY âš ï¸

## ğŸš¨ ABSOLUTE RULE - NO EXCEPTIONS ğŸš¨

**ALWAYS, ALWAYS, ALWAYS** apply Clean Code and C++ Design Patterns in **ALL** situations:

- âœ… Production code
- âœ… Quick tests
- âœ… Prototypes
- âœ… Bug fixes
- âœ… Refactoring
- âœ… New features
- âœ… Any line of code written

**NEVER, NEVER, NEVER** create code that violates Clean Code or Design Patterns, even if it's:

- âŒ "Just a quick test"
- âŒ "I'll fix it later"
- âŒ "It's temporary"
- âŒ "It works like this"

## MANDATORY Principles

### 1. Helper/Utility Functions

**CRITICAL RULE:** Any function that can be reused MUST be in a separate helpers/utilities file.

**ALWAYS:**

- âœ… Helper functions in `Utils/` or `Helpers/`
- âœ… Parameterized functions (without internal state dependency)
- âœ… Pure functions when possible
- âœ… Functions testable in isolation

**NEVER:**

- âŒ Helper functions inside classes when they can be reused
- âŒ Functions coupled to internal state when they can be parameterized
- âŒ Duplication of search/verification code

**CORRECT Example:**

```cpp
// Utils/ComponentHelpers.h
UCharacterDataComponent* FindCharacterDataComponent(AActor* Owner);

// Utils/ComponentHelpers.cpp
UCharacterDataComponent* FindCharacterDataComponent(AActor* Owner)
{
    if (!Owner) return nullptr;
    return Owner->FindComponentByClass<UCharacterDataComponent>();
}
```

**WRONG Example:**

```cpp
// âŒ NEVER do this - private function coupled
private:
    UCharacterDataComponent* FindOrGetCharacterDataComponent()
    {
        if (!CharacterDataComponent)
        {
            CharacterDataComponent = GetOwner()->FindComponentByClass<UCharacterDataComponent>();
        }
        return CharacterDataComponent;
    }
```

### 2. DRY (Don't Repeat Yourself)

**CRITICAL RULE:** If you're going to use the same logic in more than one place, create a helper function.

**ALWAYS:**

- âœ… Identify duplicated code
- âœ… Extract to helper function
- âœ… Parameterize appropriately

**NEVER:**

- âŒ Copy and paste code
- âŒ "Just this once I'll duplicate"

### 3. Single Responsibility Principle (SRP)

**CRITICAL RULE:** Each function/class must have a single responsibility.

**ALWAYS:**

- âœ… Small, focused functions
- âœ… One function = one action
- âœ… Classes with single responsibility

**NEVER:**

- âŒ Functions that do multiple things
- âŒ Classes that do everything

### 4. Separation of Concerns

**CRITICAL RULE:** Separate business logic from auxiliary logic.

**ALWAYS:**

- âœ… Helpers in separate files
- âœ… Utilities in `Utils/`
- âœ… Pure functions when possible

**NEVER:**

- âŒ Mix helpers with business logic
- âŒ Couple utility functions to specific classes

### 5. Testability

**CRITICAL RULE:** Code must be testable.

**ALWAYS:**

- âœ… Parameterized functions
- âœ… No hidden dependencies
- âœ… Pure functions when possible

**NEVER:**

- âŒ Functions coupled to global state
- âŒ Hardcoded dependencies

## MANDATORY Checklist

Before writing ANY code, ask:

- [ ] Can this function be reused? â†’ Goes to `Utils/`
- [ ] Does this function depend on internal state? â†’ Can it be parameterized?
- [ ] Am I duplicating code? â†’ Extract to helper
- [ ] Does this function have single responsibility?
- [ ] Is this function testable in isolation?
- [ ] Am I following Clean Code?
- [ ] Am I following appropriate Design Patterns?

## Helpers/Utils Structure

**ALWAYS** organize helpers in:

```text
Source/MyProject2/
â”œâ”€â”€ Utils/
â”‚   â”œâ”€â”€ ComponentHelpers.h
â”‚   â”œâ”€â”€ ComponentHelpers.cpp
â”‚   â”œâ”€â”€ MathHelpers.h
â”‚   â”œâ”€â”€ MathHelpers.cpp
â”‚   â””â”€â”€ ...
```

## When to Create Helper

**ALWAYS** create helper when:

1. âœ… Function can be used in more than one place
2. âœ… Function is pure (no side effects)
3. âœ… Function does generic search/verification
4. âœ… Function does calculation/transformation
5. âœ… Function can be tested in isolation

## Exceptions

**THERE ARE NO EXCEPTIONS.** This rule is absolute.

## Final Reminder

**EVERY** line of code must follow Clean Code and Design Patterns.

**NEVER** create "temporary" or "just for testing" code that violates these rules.

**ALWAYS** think about reusability, testability, and maintainability.

---

**This rule has MAXIMUM priority over all other rules.**
