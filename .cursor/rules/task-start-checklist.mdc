# üìã Roteiro de In√≠cio de Nova Task

## üéØ Objetivo

Este documento define o roteiro completo e obrigat√≥rio para **iniciar uma nova task**, garantindo que a branch seja criada corretamente, conectada com a issue no GitHub, e que o desenvolvimento siga TDD desde o in√≠cio.

---

## ‚úÖ Checklist de In√≠cio de Task

### 1. Verifica√ß√µes Pr√©-In√≠cio

- [ ] **Task est√° clara e bem definida?**
  - [ ] Li a documenta√ß√£o da task (arquivo `.md` em `04-Planning/ciclos/`)
  - [ ] Entendi o que precisa ser feito
  - [ ] Verifiquei depend√™ncias (outras tasks que precisam estar completas)
  - [ ] Task tem issue criada no GitHub?

- [ ] **Ambiente est√° pronto?**
  - [ ] Estou na branch `main` (ou branch base correta)
  - [ ] Branch local est√° atualizada (`git pull origin main`)
  - [ ] Working tree est√° limpo (`git status` limpo)
  - [ ] Projeto compila sem erros

### 2. Criar Branch e Conectar com Issue

- [ ] **Criar branch conectada com issue**
  - [ ] Usar script `create-task-branch.ps1`
  - [ ] Script cria branch no formato: `feat/issue-<NUMBER>__<ciclo>-<nome>`
  - [ ] Script conecta branch com issue no GitHub
  - [ ] Script move issue automaticamente para "In Progress"

**Comando:**
```powershell
cd "F:\UNREAL GAME\MyProject2"
.\scripts\github\create-task-branch.ps1 <arquivo-task.md>
```

**Exemplo:**
```powershell
.\scripts\github\create-task-branch.ps1 "fase-1\03-criacao-personagem\03-05-ac-base-mvp.md"
```

**O que o script faz:**
1. L√™ o arquivo `.md` e extrai o t√≠tulo
2. Busca a issue no GitHub pelo t√≠tulo
3. Cria branch no formato: `feat/issue-<NUMBER>__<ciclo>-<nome>`
4. Faz checkout automaticamente
5. Conecta branch com issue no GitHub
6. Tenta mover card do projeto para "In Progress"

- [ ] **Verificar que branch foi criada corretamente**
  - [ ] Branch existe localmente?
  - [ ] Estou na branch correta?
  - [ ] Branch est√° conectada com issue no GitHub?
  - [ ] Issue foi movida para "In Progress"?

**Comandos de verifica√ß√£o:**
```bash
# Verificar branch atual
git branch --show-current

# Verificar issue conectada
gh issue view <NUMBER> --json number,title,state,url
```

- [ ] **Verificar Issue Online no GitHub**
  - [ ] Issue existe no GitHub?
  - [ ] Issue tem t√≠tulo correto?
  - [ ] Issue tem labels corretos?
  - [ ] Issue tem milestone correto?
  - [ ] Issue tem assignee?
  - [ ] Issue est√° no project correto?
  - [ ] Issue est√° no status correto ("In Progress")?

**Comandos de verifica√ß√£o:**
```bash
# Verificar issue completa
gh issue view <NUMBER> --json number,title,state,labels,milestone,assignees,projectCards,url

# Verificar apenas status
gh issue view <NUMBER> --json state

# Verificar labels
gh issue view <NUMBER> --json labels

# Verificar milestone
gh issue view <NUMBER> --json milestone

# Abrir issue no navegador para verifica√ß√£o visual
gh issue view <NUMBER> --web
```

- [ ] **Sincronizar Branch com GitHub**
  - [ ] Branch local existe?
  - [ ] Branch remota existe? (se j√° foi push anteriormente)
  - [ ] Branch local est√° sincronizada com remota?
  - [ ] Fazer push da branch (se necess√°rio)

**Comandos de sincroniza√ß√£o:**
```bash
# Verificar se branch remota existe
git ls-remote --heads origin <branch-name>

# Verificar status da branch
git status

# Verificar diferen√ßas entre local e remota
git fetch origin
git log HEAD..origin/<branch-name>  # Commits na remota que n√£o est√£o local
git log origin/<branch-name>..HEAD  # Commits locais que n√£o est√£o na remota

# Fazer push da branch (primeira vez)
git push -u origin <branch-name>

# Fazer push de commits novos
git push origin <branch-name>

# Sincronizar branch local com remota (se remota existe)
git pull origin <branch-name>
```

### 3. Iniciar Desenvolvimento (TDD)

- [ ] **Escrever testes PRIMEIRO (TDD - Red)**
  - [ ] Criar arquivo de testes (se n√£o existir)
  - [ ] Escrever testes que definem comportamento esperado
  - [ ] Testes devem falhar inicialmente (Red)
  - [ ] Seguir `test-driven-development-core.mdc`
  - [ ] Valores esperados hardcoded (sem l√≥gica interna)

**Localiza√ß√£o dos testes:**
```
Source/MyProject2/Tests/Task_<X.Y>_<Nome>/<Nome>Tests.cpp
```

**Estrutura do teste:**
```cpp
BEGIN_DEFINE_SPEC(<Nome>Spec, "MyProject2.<Categoria>", 
                  EAutomationTestFlags::EditorContext | EAutomationTestFlags::ProductFilter)
END_DEFINE_SPEC(<Nome>Spec)

void <Nome>Spec::Define()
{
    Describe("Issue-<X.Y>/ <Subcategoria>", [this]()
    {
        It("deve <comportamento esperado>", [this]()
        {
            // Arrange
            // Act
            // Assert
            TestEqual("Descri√ß√£o", Result, ExpectedValue);
        });
    });
}
```

- [ ] **Verificar que testes falham (Red)**
  - [ ] Executar testes
  - [ ] Confirmar que falham (como esperado)
  - [ ] Se testes passam, revisar - podem estar errados

**Comando para executar testes:**
```powershell
.\scripts\tests\run_tests_with_categories.ps1
# Selecionar categoria da task (ex: Issue-3.5)
```

### 4. Implementa√ß√£o M√≠nima (TDD - Green)

- [ ] **Implementar funcionalidade m√≠nima**
  - [ ] Implementar apenas o necess√°rio para testes passarem
  - [ ] N√£o fazer over-engineering
  - [ ] Focar em fazer testes passarem (Green)

- [ ] **Verificar que testes passam (Green)**
  - [ ] Executar testes novamente
  - [ ] Confirmar que todos passam
  - [ ] Se algum falha, corrigir implementa√ß√£o

### 5. Refatora√ß√£o (TDD - Refactor)

- [ ] **Refatorar com seguran√ßa**
  - [ ] Melhorar c√≥digo mantendo testes passando
  - [ ] Aplicar Clean Code (`clean-code-mandatory.mdc`)
  - [ ] Seguir arquitetura do projeto (`project-architecture.mdc`)
  - [ ] Manter modularidade

- [ ] **Verificar que testes ainda passam (Refactor)**
  - [ ] Executar testes ap√≥s refatora√ß√£o
  - [ ] Confirmar que todos ainda passam
  - [ ] Se algum falha, revisar refatora√ß√£o

### 6. Commits Durante Desenvolvimento

- [ ] **Fazer commits frequentes**
  - [ ] Commits pequenos e focados
  - [ ] Usar formato Conventional Commits
  - [ ] Mensagem descritiva do que foi feito
  - [ ] Nunca commitar c√≥digo sem testes (se aplic√°vel TDD)

**Formato de commit:**
```bash
git commit -m "feat(Module): implementar funcionalidade X

- Detalhes do que foi implementado
- Testes adicionados
- Refatora√ß√µes realizadas"
```

---

## üîç Verifica√ß√µes Intermedi√°rias

**SEMPRE verificar ap√≥s cada passo:**

### Ap√≥s Criar Branch
- [ ] Branch foi criada corretamente?
- [ ] Branch est√° conectada com issue?
- [ ] Issue foi movida para "In Progress"?
- [ ] Estou na branch correta?

### Ap√≥s Verificar Issue Online
- [ ] Issue existe e tem informa√ß√µes corretas?
- [ ] Labels est√£o corretos?
- [ ] Milestone est√° correto?
- [ ] Assignee est√° definido?
- [ ] Issue est√° no project correto?
- [ ] Status est√° "In Progress"?

### Ap√≥s Sincronizar Branch
- [ ] Branch local e remota est√£o sincronizadas?
- [ ] N√£o h√° commits divergentes?
- [ ] Push foi realizado com sucesso?

### Ap√≥s Escrever Testes (Red)
- [ ] Testes compilam?
- [ ] Testes falham como esperado?
- [ ] Testes definem comportamento claramente?
- [ ] Valores esperados s√£o hardcoded?

### Ap√≥s Implementa√ß√£o (Green)
- [ ] Testes passam?
- [ ] Implementa√ß√£o √© m√≠nima?
- [ ] N√£o h√° over-engineering?

### Ap√≥s Refatora√ß√£o (Refactor)
- [ ] Testes ainda passam?
- [ ] C√≥digo segue Clean Code?
- [ ] C√≥digo segue arquitetura?
- [ ] Modularidade mantida?

---

## üìã Template de Comandos

### Iniciar Nova Task Completo

```bash
# 1. Ir para main e atualizar
cd "F:\UNREAL GAME\MyProject2"
git checkout main
git pull origin main

# 2. Criar branch conectada com issue
.\scripts\github\create-task-branch.ps1 "fase-1\03-criacao-personagem\03-05-ac-base-mvp.md"

# 3. Verificar que branch foi criada
git branch --show-current
gh issue view <NUMBER> --json number,title,state

# 4. Verificar Issue Online no GitHub
gh issue view <NUMBER> --json number,title,state,labels,milestone,assignees,projectCards,url
gh issue view <NUMBER> --web  # Abrir no navegador para verifica√ß√£o visual

# 5. Sincronizar Branch com GitHub
git fetch origin
git status  # Verificar status
git push -u origin <branch-name>  # Push inicial (se necess√°rio)

# 6. Criar arquivo de testes (se necess√°rio)
# Criar: Source/MyProject2/Tests/Task_<X.Y>_<Nome>/<Nome>Tests.cpp

# 7. Escrever testes (TDD - Red)
# Implementar testes que falham

# 8. Executar testes para confirmar que falham
.\scripts\tests\run_tests_with_categories.ps1

# 9. Implementar funcionalidade m√≠nima (TDD - Green)
# Fazer testes passarem

# 10. Executar testes para confirmar que passam
.\scripts\tests\run_tests_with_categories.ps1

# 11. Refatorar (TDD - Refactor)
# Melhorar c√≥digo mantendo testes passando

# 12. Executar testes para confirmar que ainda passam
.\scripts\tests\run_tests_with_categories.ps1

# 13. Commitar mudan√ßas
git add -A
git commit -m "feat(Module): implementar funcionalidade X"
```

---

## üîç Como Obter Informa√ß√µes da Task

### Arquivo da Task

Localiza√ß√£o: `F:\UNREAL GAME\minasphandelver\Documentacao\04-Planning\ciclos\fase-<X>\<categoria>\<XX-XX-nome-task>.md`

### Issue Number

- Geralmente est√° no nome da branch ap√≥s criar: `feat/issue-<NUMBER>__...`
- Ou no arquivo de documenta√ß√£o da task
- Ou buscar no GitHub pelo t√≠tulo da task

### Labels e Milestone

As informa√ß√µes est√£o na documenta√ß√£o da task:

```markdown
**Milestone:** Fase 1: Come√ßo
**Label:** Sys: Character, P0: Critical
```

---

## ‚ö†Ô∏è Importante

**SEMPRE verificar antes de come√ßar:**

1. ‚úÖ Task est√° clara e bem definida?
2. ‚úÖ Depend√™ncias est√£o completas?
3. ‚úÖ Estou na branch correta (main atualizada)?
4. ‚úÖ Working tree est√° limpo?
5. ‚úÖ Branch foi criada e conectada com issue?
6. ‚úÖ Issue foi movida para "In Progress"?
7. ‚úÖ Issue online tem labels, milestone, assignee corretos?
8. ‚úÖ Branch est√° sincronizada com GitHub (push realizado)?

**NUNCA come√ßar sem:**
- ‚ùå Task n√£o clara ou mal definida
- ‚ùå Depend√™ncias n√£o completas
- ‚ùå Branch n√£o criada
- ‚ùå Branch n√£o conectada com issue
- ‚ùå Working tree sujo (commits n√£o commitados)

---

## üîó Integra√ß√£o com Outras Regras

### Task Execution

**Este roteiro complementa `task-execution.mdc`:**
- `task-start-checklist.mdc`: **COMO** come√ßar uma task (roteiro passo a passo)
- `task-execution.mdc`: **COMO** executar uma task (TDD, modularidade, etc.)

### Test-Driven Development

**Seguir `test-driven-development-core.mdc`:**
- Testes PRIMEIRO (Red)
- Implementa√ß√£o m√≠nima (Green)
- Refatora√ß√£o (Refactor)

### Clean Code

**Seguir `clean-code-mandatory.mdc`:**
- Helpers em `Utils/` ou `Helpers/`
- Fun√ß√µes puras e test√°veis
- Single Responsibility Principle
- DRY (Don't Repeat Yourself)

### Project Architecture

**Seguir `project-architecture.mdc`:**
- Data-Driven (Data Tables/Assets)
- Modularidade
- Editor-Friendly
- Multiplayer-Ready

---

## üìö Refer√™ncias

### Scripts Relacionados

- `scripts/github/create-task-branch.ps1` - Criar branch conectada com issue
- `scripts/tests/run_tests_with_categories.ps1` - Executar testes por categoria

### Regras Relacionadas

- `.cursor/rules/task-execution.mdc` - Execu√ß√£o de tasks (TDD, modularidade)
- `.cursor/rules/task-finalization-checklist.mdc` - Finaliza√ß√£o de tasks
- `.cursor/rules/test-driven-development-core.mdc` - Metodologia TDD
- `.cursor/rules/clean-code-mandatory.mdc` - Clean Code obrigat√≥rio
- `.cursor/rules/project-architecture.mdc` - Arquitetura do projeto

---

## üìù Fluxo Completo Resumido

1. **Verificar Task** ‚Üí Ler documenta√ß√£o, verificar depend√™ncias ‚úÖ
2. **Atualizar Main** ‚Üí `git checkout main && git pull origin main` ‚úÖ
3. **Criar Branch** ‚Üí `create-task-branch.ps1 <arquivo-task.md>` ‚úÖ
4. **Verificar Branch** ‚Üí Confirmar cria√ß√£o e conex√£o com issue ‚úÖ
5. **Verificar Issue Online** ‚Üí Confirmar labels, milestone, assignee, project ‚úÖ
6. **Sincronizar Branch** ‚Üí Verificar e fazer push se necess√°rio ‚úÖ
7. **Escrever Testes** ‚Üí TDD Red (testes que falham) ‚úÖ
8. **Implementar** ‚Üí TDD Green (implementa√ß√£o m√≠nima) ‚úÖ
9. **Refatorar** ‚Üí TDD Refactor (melhorar c√≥digo) ‚úÖ
10. **Commits** ‚Üí Commits frequentes e descritivos ‚úÖ

---

**√öltima atualiza√ß√£o:** 2025-01-25
